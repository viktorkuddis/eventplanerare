


import styles from "./EventLayout.module.css";
import { useContext, useEffect, type ReactNode } from 'react';
import { useNavigate } from "react-router-dom";

import { Home, Info, Settings } from "react-feather";

import { AppContext } from "../../src/context /AppContext";
import { useParams } from "react-router-dom";

import { useDbApi } from "../../src/api/useDbApi";


// TODO: SE TILL ATT LETA I DATABASEN S칀 ATT USER ID FINNS MED EN PACPISITPANT s친 att vi har access att h칛mta allt som detta eventet asosieras med. vi kan g칬ra de i rutten d칛r vi ber om hela eventdetails.  just nu g칬r vi inte detta.

type Props = {
    children?: ReactNode;
};
const EventLayout = ({ children }: Props) => {

    const { eventId } = useParams();

    console.log(eventId)

    const context = useContext(AppContext)

    console.log(context?.currentEventObject)

    const navigate = useNavigate()
    const { getEventDetailsById } = useDbApi();

    // kollar om den redan finns i kontexten is친fall kan vi tempor칛rt nu s칛tta den som aktuellt event tills vi laddat fr친n databasen.




    useEffect(() => {

        const eventFoundInContext = context?.eventObjectsDetailed?.find(e => e.event._id == eventId)
        if (eventFoundInContext) {
            context?.setCurrentEventObjectsDetailed(eventFoundInContext)
            console.log("游땙eventet fanns i contexten. s칛tter tillf칛lligt till current event tills svar fr친n databasen eventuellt skriver 칬ver")
        }
        // 칀칀 VI H츿MTAR OBJEKTET fr친n databasen :) Vi vill alltid h칛mta nytt fr친n databasen n칛r denne sidan laddas 
        if (eventId) {
            getEventDetailsById(eventId)
        }
        // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [eventId]);




    return (
        <>
            <div className={styles.backdrop}>


                <div className={`${styles.pageWrapper}`}>


                    <header className={`${styles.headerWrapper}`}>
                        <div className={`${styles.header} content-container-width-wrapper`}>
                            <div className={styles.headerLeft}>
                                <button className={styles.homeButton} onClick={() => navigate("/")}>
                                    <Home size={24} />
                                </button>

                            </div>
                            <div className={styles.headerMiddle}>


                                <div>{context?.currentEventObject?.title}</div>

                            </div>
                            <div className={styles.headerRight}>

                                <button className=" btn-small btn-circle btn-filled-light-static">
                                    <div style={{ height: "1.25rem", aspectRatio: "1/1" }}>
                                        <Info size={"1.25rem"} />
                                    </div>
                                </button>

                                <button className="btn-small btn-circle btn-filled-light-static">
                                    <div style={{ height: "1.25rem", aspectRatio: "1/1" }}>
                                        <Settings size={"1.25rem"} />
                                    </div>

                                </button>


                            </div>
                        </div>

                    </header >
                    <main>
                        {children}



                    </main>
                </div >
            </div>


            {/* </div > */}

        </>
    );
};
export default EventLayout




